<div class="section-title"> Datos del envío </div>

<form [formGroup]="form" empNgFormKeyDownEnter autocomplete="off" class="form-section">

  <div class="fx-column-container fx-gap-three-quarter">

    <div class="fx-row-container">

      <div class="fx-item-third">
        <label>Paquetería:</label>
        <emp-ng-select
          formControlName="parcelSupplier"
          [items]="parcelSuppliersList"
          [loading]="isLoading"
          [showError]="formHelper.isControlInvalid(form.controls.parcelSupplier)">
        </emp-ng-select>
      </div>

      <div class="fx-item">
        <label>Número de guía:</label>
        <input type="text" class="text-box"
          formControlName="shippingGuide"
          [class.invalid-control]="formHelper.isControlInvalid(form.controls.shippingGuide)">
      </div>

      <div class="fx-row-container fx-item-third">

        <div class="fx-item-half">
          <label>Importe de la paquetería:</label>
          <input type="text" class="text-box text-align-right" empNgCurrency
            empNgInputName="parcelAmount"
            formControlName="parcelAmount"
            [class.invalid-control]="formHelper.isControlInvalid(form.controls.parcelAmount)">
        </div>

        <div class="fx-item-half">
          <label>Importe cobrado al cliente:</label>
          <input type="text" class="text-box text-align-right" empNgCurrency
            empNgInputName="customerAmount"
            formControlName="customerAmount"
            [class.invalid-control]="formHelper.isControlInvalid(form.controls.customerAmount)">
        </div>

      </div>

      <div *ngIf="canEdit && form.value.customerAmount > 0"
        class="fx-item-none fx-end fx-items-end"
        [style.paddingBottom.px]="2">
        <button class="btn" [style.width.px]="100">
          Autorizar
        </button>
      </div>

    </div>

  </div>

  <ng-container *ngIf="canEdit || canSendOrder" #rowFooter>

    <mat-divider class="horizontal">

    </mat-divider>

    <div class="fx-row-container">

      <div class="fx-item fx-start fx-items-center">

        <button *ngIf="canSendOrder"
          type="button" class="btn"
          (click)="onSendOrder()">
          Enviar a embarque
        </button>

      </div>

      <div class="fx-item fx-center fx-items-center">
          <mat-checkbox name="putOnPallets"
            [ngModel]="putOnPallets" [ngModelOptions]="{standalone: true}"
            (ngModelChange)="putOnPalletsChange.emit($event)"
            (click)="$event.stopPropagation">
            Entarimar paquetes
          </mat-checkbox>
      </div>

      <div class="fx-item fx-end fx-items-center"*ngIf="canEdit">

        <ng-container *ngIf="canEdit">

          <button
            [class.btn]="!formHelper.isFormReady(form)"
            [class.btn-action]="formHelper.isFormReady(form)"
            [style.width.px]="100"
            (click)="onSubmitButtonClicked()">
            Guardar
          </button>

        </ng-container>

      </div>

    </div>

  </ng-container>

</form>
